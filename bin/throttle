#!/usr/bin/env ruby

begin
  require 'throttle'
rescue LoadError
  require 'rubygems'
  require 'throttle'
end

#throttle limit 500Kbps
#throttle limit 600Kbps
#throttle status
#throttle reset

def error(str)
  puts "Error: #{str}"
end

throttle = Throttle.new

case ARGV[0]
when "limit"
  if ARGV[1]
    throttle.limit(ARGV[1])
    puts throttle.status
  else
    error("Please provide a valid bit rate to limit.")
  end    
when "status"
  puts throttle.status
when "reset"    
  throttle.reset
  puts throttle.status
else
  puts "\nThrottling: "
  puts "\n\n"
  puts "\nthrottle limit [bandwidth]"
  puts "\nthrottle limit 500KBps"
  puts "\nthrottle limit 12Mbps"
  puts "\n\n"
  puts "\nGet the current status:"
  puts "\n\n"
  puts "\nthrottle status"
  puts "\n\nTurn off:"
  puts "\nthrottle reset"  
end  
